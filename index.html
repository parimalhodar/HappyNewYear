<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Happy Diwali Wishes</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0a0015 0%, #1a0033 50%, #2d0052 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            overflow-x: hidden;
            overflow-y: auto;
            position: relative;
            cursor: pointer;
            padding: 30px 0;
        }

        .fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            touch-action: none;
        }

        .container {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 15px;
            max-width: 600px;
            width: 95%;
            margin: auto;
        }

        .diya-container {
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
            pointer-events: none;
        }

        .diya {
            font-size: 70px;
            filter: drop-shadow(0 0 20px #ffa500);
            animation: flicker 2s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; filter: drop-shadow(0 0 20px #ffa500); }
            50% { opacity: 0.8; filter: drop-shadow(0 0 30px #ff8c00); }
        }

        .greeting-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px 20px;
            box-shadow: 0 8px 32px rgba(255, 165, 0, 0.3);
            border: 2px solid rgba(255, 165, 0, 0.3);
            animation: slideIn 1s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .title {
            font-family: 'Playfair Display', serif;
            font-size: 42px;
            color: #ffd700;
            margin-bottom: 12px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: glow 2s ease-in-out infinite;
            line-height: 1.2;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
            50% { text-shadow: 0 0 30px rgba(255, 215, 0, 1); }
        }

        .subtitle {
            font-size: 18px;
            color: #fff;
            margin-bottom: 20px;
            font-weight: 300;
        }

        .message {
            font-size: 15px;
            color: #ffe4b5;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .sender-name {
            font-size: 22px;
            color: #ffb347;
            font-weight: 600;
            margin-top: 15px;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(255, 179, 71, 0.5);
        }

        .button-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            margin-top: 15px;
        }

        .share-btn {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 17px;
            border-radius: 50px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            width: 100%;
            max-width: 320px;
            touch-action: manipulation;
            user-select: none;
            min-height: 52px;
            position: relative;
            z-index: 10;
        }

        .share-btn:active {
            transform: scale(0.98);
            box-shadow: 0 3px 10px rgba(37, 211, 102, 0.6);
        }

        .whatsapp-icon {
            font-size: 22px;
            pointer-events: none;
        }

        .decorative-dots {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 18px 0;
            pointer-events: none;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #ffd700;
            border-radius: 50%;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.7; }
        }

        .name-input-container {
            margin-top: 15px;
            display: none;
        }

        .name-input {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 12px;
            padding: 14px 18px;
            color: white;
            font-size: 16px;
            width: 100%;
            max-width: 320px;
            margin: 10px auto;
            display: block;
            text-align: center;
            font-family: 'Poppins', sans-serif;
            touch-action: manipulation;
        }

        .name-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .name-input:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }

        .create-btn, .update-btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            color: #2d0052;
            border: none;
            padding: 14px 30px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            margin: 8px 5px;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
            touch-action: manipulation;
            user-select: none;
            min-height: 50px;
            min-width: 150px;
        }

        .create-btn:active, .update-btn:active {
            transform: scale(0.98);
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.6);
        }

        .tap-hint {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            z-index: 10;
            animation: bounce 2s ease-in-out infinite;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 16px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
            pointer-events: none;
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        .footer {
            text-align: center;
            padding: 25px 20px;
            margin-top: 30px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            position: relative;
            z-index: 2;
        }

        .footer-text {
            margin-bottom: 8px;
            font-weight: 500;
            color: #ffb347;
            text-shadow: 0 0 10px rgba(255, 179, 71, 0.3);
        }

        .footer-email {
            color: rgba(255, 255, 255, 0.6);
            font-size: 13px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-email:hover {
            color: #ffd700;
        }

        @media (max-width: 600px) {
            .title { 
                font-size: 34px;
            }
            .subtitle { 
                font-size: 16px;
            }
            .message { 
                font-size: 14px;
            }
            .sender-name { 
                font-size: 20px;
            }
            .greeting-card { 
                padding: 20px 15px;
            }
            .footer {
                padding: 20px 15px;
                margin-top: 20px;
                font-size: 13px;
            }
            .footer-email {
                font-size: 12px;
            }
            .diya {
                font-size: 60px;
            }
            .diya-container {
                margin-bottom: 15px;
            }
            .share-btn {
                font-size: 16px;
                padding: 14px 28px;
                max-width: 300px;
            }
            .create-btn, .update-btn {
                font-size: 15px;
                padding: 13px 26px;
                min-width: 140px;
            }
            .name-input {
                font-size: 15px;
                padding: 13px 16px;
                max-width: 300px;
            }
            .tap-hint {
                font-size: 12px;
                bottom: 20px;
                padding: 7px 14px;
            }
        }

        @media (max-width: 400px) {
            .title { 
                font-size: 30px;
            }
            .subtitle { 
                font-size: 15px;
            }
            .message { 
                font-size: 13px;
            }
            .greeting-card { 
                padding: 20px 15px;
            }
            .share-btn {
                font-size: 15px;
                padding: 13px 24px;
            }
        }
    </style>
</head>
<body>
    <canvas class="fireworks-canvas" id="fireworks"></canvas>
    
    <div class="tap-hint" id="tapHint">👆 Tap anywhere to light crackers! 🎆</div>

    <div class="container">
        <div class="diya-container">
            <div class="diya">🪔</div>
        </div>

        <div class="greeting-card">
            <h1 class="title">Happy Diwali!</h1>
            
            <div class="decorative-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>

            <p class="subtitle">✨ Festival of Lights ✨</p>
            
            <p class="message">
                May this Diwali bring joy, prosperity, and happiness to your life. 
                May the divine light of diyas brighten your days and illuminate your path to success.
                Wishing you and your family a blessed and prosperous Diwali! 🎆
            </p>

            <div class="decorative-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>

            <div id="senderDisplay">
                <p class="sender-name">~ <span id="senderName">Your Friend</span> 💫</p>
                <div class="button-container">
                    <button class="update-btn" id="updateNameBtn" onclick="showUpdateName()">Update Name</button>
                </div>
            </div>

            <div class="name-input-container" id="nameInputContainer">
                <input type="text" class="name-input" id="nameInput" placeholder="Enter your name" maxlength="50">
                <div class="button-container">
                    <button class="create-btn" id="createBtn" onclick="createPersonalizedLink()">Create My Wish</button>
                    <button class="create-btn" id="saveNameBtn" onclick="updatePersonalizedLink()" style="display: none;">Save New Name</button>
                </div>
            </div>

            <div class="button-container">
                <button class="share-btn" id="shareBtn" onclick="shareOnWhatsApp()">
                    <span class="whatsapp-icon">📱</span>
                    <span>Share on WhatsApp</span>
                </button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-text">Developed by Parimal Hodar</div>
        <a href="mailto:parimalhodar.dev@gmail.com" class="footer-email">parimalhodar.dev@gmail.com</a>
    </footer>

    <script>
        // Prevent accidental zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Get sender name from URL
        function getSenderName() {
            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('from');
            return name ? decodeURIComponent(name) : null;
        }

        // Initialize page
        function initializePage() {
            const senderName = getSenderName();
            if (senderName) {
                document.getElementById('senderName').textContent = senderName;
                document.getElementById('senderDisplay').style.display = 'block';
                document.getElementById('nameInputContainer').style.display = 'none';
                document.getElementById('updateNameBtn').style.display = 'inline-block';
            } else {
                document.getElementById('senderDisplay').style.display = 'none';
                document.getElementById('nameInputContainer').style.display = 'block';
                document.getElementById('updateNameBtn').style.display = 'none';
            }
            document.getElementById('nameInput').value = senderName || '';
        }

        // Show name input for updating
        function showUpdateName() {
            document.getElementById('nameInputContainer').style.display = 'block';
            document.getElementById('createBtn').style.display = 'none';
            document.getElementById('saveNameBtn').style.display = 'inline-block';
            document.getElementById('updateNameBtn').style.display = 'none';
            document.getElementById('nameInput').focus();
        }

        // Create personalized link
        function createPersonalizedLink() {
            const name = document.getElementById('nameInput').value.trim();
            if (name) {
                const baseUrl = window.location.origin + window.location.pathname;
                const personalizedUrl = `${baseUrl}?from=${encodeURIComponent(name)}`;
                window.location.href = personalizedUrl;
            } else {
                alert('Please enter your name!');
            }
        }

        // Update personalized link with new name
        function updatePersonalizedLink() {
            const name = document.getElementById('nameInput').value.trim();
            if (name) {
                const baseUrl = window.location.origin + window.location.pathname;
                const personalizedUrl = `${baseUrl}?from=${encodeURIComponent(name)}`;
                window.location.href = personalizedUrl;
            } else {
                alert('Please enter a new name!');
            }
        }

        // Share on WhatsApp with improved handling
        function shareOnWhatsApp() {
            const senderName = getSenderName();
            let message, url;
            
            if (senderName) {
                message = `🪔 *Happy Diwali! & Happy New Year* 🎆\n\nMay this Diwali bring joy, prosperity,\nand happiness to your life.\nMay the divine light of diyas\nbrighten your days and illuminate\nyour path to success.\nWishing you and your family\na blessed and prosperous Diwali!\n\nFrom: *${senderName}* ✨\n\nView the animated greeting card here:\n`;
                url = window.location.href;
            } else {
                const name = document.getElementById('nameInput').value.trim();
                if (!name) {
                    alert('Please enter your name first to create a personalized wish!');
                    return;
                }
                const baseUrl = window.location.origin + window.location.pathname;
                url = `${baseUrl}?from=${encodeURIComponent(name)}`;
                message = `🪔 *Happy Diwali! & Happy New Year* 🎆\n\nMay this Diwali bring joy, prosperity,\nand happiness to your life.\nMay the divine light of diyas\nbrighten your days and illuminate\nyour path to success.\nWishing you and your family\na blessed and prosperous Diwali!\n\nFrom: *${name}* ✨\n\nView the animated greeting card here:\n`;
            }
            
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message + url)}`;
            
            // Better handling for mobile
            if (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                window.location.href = whatsappUrl;
            } else {
                window.open(whatsappUrl, '_blank');
            }
        }

        // Fireworks Animation
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        class Particle {
            constructor(x, y, color, speed = 1) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.velocity = {
                    x: (Math.random() - 0.5) * 10 * speed,
                    y: (Math.random() - 0.5) * 10 * speed
                };
                this.alpha = 1;
                this.decay = Math.random() * 0.015 + 0.015;
                this.radius = Math.random() * 3 + 1;
                this.gravity = 0.15;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                
                const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.radius * 3);
                gradient.addColorStop(0, this.color);
                gradient.addColorStop(1, 'transparent');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius * 3, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.restore();
            }

            update() {
                this.velocity.y += this.gravity;
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= this.decay;
            }
        }

        class Spark {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 3 + 2;
                this.velocity = {
                    x: Math.cos(angle) * speed,
                    y: Math.sin(angle) * speed
                };
                this.alpha = 1;
                this.decay = 0.02;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x - this.velocity.x * 2, this.y - this.velocity.y * 2);
                ctx.stroke();
                ctx.restore();
            }

            update() {
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.velocity.y += 0.2;
                this.alpha -= this.decay;
            }
        }

        let particles = [];
        let sparks = [];
        const colors = ['#ffd700', '#ffb347', '#ff6347', '#ff1493', '#00ffff', '#00ff00', '#ffffff', '#ff69b4'];

        function createFirework(x, y, intensity = 1) {
            const color = colors[Math.floor(Math.random() * colors.length)];
            const particleCount = 50 * intensity;
            
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle(x, y, color, intensity));
            }
            
            for (let i = 0; i < 15 * intensity; i++) {
                sparks.push(new Spark(x, y, color));
            }
        }

        function animate() {
            ctx.fillStyle = 'rgba(10, 0, 21, 0.15)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            for (let i = particles.length - 1; i >= 0; i--) {
                const particle = particles[i];
                if (particle.alpha <= 0) {
                    particles.splice(i, 1);
                } else {
                    particle.update();
                    particle.draw();
                }
            }

            for (let i = sparks.length - 1; i >= 0; i--) {
                const spark = sparks[i];
                if (spark.alpha <= 0) {
                    sparks.splice(i, 1);
                } else {
                    spark.update();
                    spark.draw();
                }
            }

            requestAnimationFrame(animate);
        }

        // Handle clicks and touches
        let lastFireworkTime = 0;
        const minFireworkInterval = 100;

        function handleInteraction(e) {
            const now = Date.now();
            
            if (now - lastFireworkTime < minFireworkInterval) return;
            lastFireworkTime = now;

            let x, y;
            if (e.type.startsWith('touch')) {
                const touch = e.touches[0] || e.changedTouches[0];
                x = touch.clientX;
                y = touch.clientY;
            } else {
                x = e.clientX;
                y = e.clientY;
            }

            createFirework(x, y, 1.5);
        }

        canvas.addEventListener('click', handleInteraction);
        canvas.addEventListener('touchstart', handleInteraction, { passive: true });
        canvas.addEventListener('touchmove', (e) => {
            if (e.touches.length > 0) {
                handleInteraction(e);
            }
        }, { passive: true });

        // Start animation
        animate();

        // Initialize page on load
        initializePage();

        // Hide tap hint after first interaction
        let hintHidden = false;
        function hideHint() {
            if (!hintHidden) {
                const hint = document.getElementById('tapHint');
                hint.style.transition = 'opacity 0.5s ease';
                hint.style.opacity = '0';
                setTimeout(() => {
                    hint.style.display = 'none';
                }, 500);
                hintHidden = true;
            }
        }

        canvas.addEventListener('click', hideHint, { once: true });
        canvas.addEventListener('touchstart', hideHint, { once: true });
    </script>
</body>
</html>
